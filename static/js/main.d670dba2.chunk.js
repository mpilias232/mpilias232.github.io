(this.webpackJsonpadmintry=this.webpackJsonpadmintry||[]).push([[0],{1102:function(e,t,n){},1548:function(e,t,n){},1549:function(e,t,n){},1550:function(e,t,n){},1551:function(e,t,n){},1552:function(e,t,n){},1553:function(e,t,n){},1646:function(e,t){},1670:function(e,t){},1708:function(e,t){},1741:function(e,t,n){},1742:function(e,t,n){},1743:function(e,t,n){},1744:function(e,t,n){},1747:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(36),i=n.n(c),s=(n(1102),n(831)),o=n(794),l=n(997),u=n(998),d=(n(15),n(96)),j=n(111),b=n(12),p=n.n(b),f=n(35),h=n(26),m=n(135),O=n(104),x=n(53),g=n(820),v=n(822),y=n(526),k=n(125),C=n(823),w=n(38),S=(n(1005),n(2)),P=(Object(w.a)({link:{textDecoration:"none"},icon:{width:"0.5em",paddingLeft:2}}),n(624),n(182)),D=n.n(P),M=(n(456),n(388)),N=n.n(M),E=n(204),I=n.n(E),A=n(183),T=n.n(A),F=(n(186),n(149)),L=n.n(F),Y=n(145),W=n(49),_=n.n(W),B=n(179),U=n.n(B),q=n(251),R=n.n(q);window.moment=_.a;n(187);function Q(e){var t=Object(m.a)(),n=a.useState({}),r=Object(h.a)(n,2),c=r[0],i=r[1],s=a.useState(!1),o=Object(h.a)(s,2),l=o[0],u=o[1],d=a.useState([]),j=Object(h.a)(d,2),b=j[0],v=j[1],y=a.useState(!0),k=Object(h.a)(y,2),C=(k[0],k[1],a.useState()),w=Object(h.a)(C,2),P=(w[0],w[1],a.useState(null)),M=Object(h.a)(P,2),N=M[0],E=M[1],I=a.useState({}),A=Object(h.a)(I,2),T=A[0],F=A[1],Y=a.useState(!1),W=Object(h.a)(Y,2),_=W[0],B=W[1],q=function(e){return{onClick:function(){N.current.startEdit({columnId:e.id,rowIndex:e.rowIndex})}}},R=Object.assign({},D.a.defaultProps.filterTypes,{dogs:{type:"string",emptyValue:"",operators:[{name:"contains",fn:function(e){var t=e.value,n=e.filterValue;e.data;return!n||t&&t.map((function(e){if(-1!=e.dog_name.toLowerCase().indexOf(n.toLowerCase()))return!0}))[0]}}]}}),Q=[{name:"name",header:"Name",defaultWidth:200,editable:!1},{name:"email",header:"E-mail",defaultWidth:280,render:function(e){var t=e.value;return Object(S.jsx)("a",{href:"mailto:"+t,children:t})},cellDOMProps:q},{name:"phone",header:"Phone",defaultWidth:150,cellDOMProps:q},{name:"dog",header:"Dog",defaultWidth:200,render:function(e){var t=e.value;e.data;try{return Object(S.jsx)(S.Fragment,{children:t.map((function(e){return Object(S.jsx)("a",{href:"#dogs/"+e.id,children:Object(S.jsx)("span",{style:{paddingRight:"5px"},children:e.dog_name})})}))})}catch(n){return}},editable:!1},{name:"instagram",header:"Instagram",defaultWidth:150,cellDOMProps:q},{name:"suburb",header:"Suburb",defaultWidth:150,cellDOMProps:q}],V={hidden:[],sortInfo:[],reservedViewportWidth:0,columnOrder:Q.map((function(e){return e.name}))},G=function(){return JSON.parse(localStorage.getItem("state-".concat(e.title)))},J=function(t){localStorage.setItem("state-".concat(e.title),JSON.stringify(t))},z=a.useState(Q),H=Object(h.a)(z,2),K=H[0],X=H[1];a.useEffect((function(){var t=localStorage.getItem("state-".concat(e.title))||{};if(0===Object.keys(t).length)F(V),J(V);else{var n=JSON.parse(t);if(0!=n.hidden.length){var a=K;n.hidden.forEach((function(e){return a.forEach((function(t){t.name==e&&(t.visible=!1)}))})),X(a)}F(n)}}),[_]),a.useEffect((function(){function n(){return(n=Object(f.a)(p.a.mark((function n(){var a,r;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.getList("dogs",{pagination:{page:1,perPage:1e6}});case 2:a=n.sent,(r=e.rows||[]).forEach((function(e){e.dog=a.data.filter((function(t){return t.owner===e.id}))})),v(r);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[e.rows]);return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(O.b,{title:e.title}),Object(S.jsxs)("div",{children:[Object(S.jsx)(x.a,{label:"Filters",onClick:function(){return u(!l)},children:Object(S.jsx)(U.a,{})}),1===Object.keys(c).length&&Object(S.jsx)(g.a,{basePath:"/clients",label:"Edit",record:Object.values(c)[0]}),0!==Object.keys(c).length&&Object(S.jsx)(x.a,{label:"Message Client",children:Object(S.jsx)(L.a,{})})]}),Object(S.jsx)(D.a,{idProperty:"id",columns:K,columnOrder:T.columnOrder,dataSource:b,filterTypes:R,onReady:E,onEditComplete:function(e){var n=e.value,a=e.columnId,r=(e.rowIndex,e.data);try{if("suburb"===a){var c=b;c[c.findIndex((function(e){return e.id===r.id}))].suburb=n,v(c),t.update("clients",{id:r.id,data:{suburb:n}})}else if("instagram"===a){var i=b;i[i.findIndex((function(e){return e.id===r.id}))].instagram=n,v(i),t.update("clients",{id:r.id,data:{instagram:n}})}else if("phone"===a){var s=b;s[s.findIndex((function(e){return e.id===r.id}))].phone=n,v(s),t.update("clients",{id:r.id,data:{phone:n}})}else if("email"===a){var o=b;o[o.findIndex((function(e){return e.id===r.id}))].email=n,v(o),t.update("clients",{id:r.id,data:{email:n}})}}catch(l){}},editable:!0,style:{minHeight:550},onColumnOrderChange:function(e){var t=G();t.columnOrder=e,F(t),J(t)},onColumnVisibleChange:function(e){var t=e.column,n=e.visible,a=G();if(n){var r=a.hidden.find((function(e){return e==t.name}));r&&a.hidden.splice(a.hidden.indexOf(r),1),J(a);var c=K;c.forEach((function(e){e.name==t.name&&(e.visible=!0)})),X(c),B(!_)}else{!a.hidden.find((function(e){return e==t.name}))&&a.hidden.push(t.name),J(a),B(!_)}},defaultFilterValue:[{name:"phone",operator:"contains",type:"string",value:""},{name:"email",operator:"contains",type:"string",value:""},{name:"name",operator:"contains",type:"string",value:""},{name:"dog",operator:"contains",type:"dogs",value:""},{name:"instagram",operator:"contains",type:"string",value:""},{name:"suburb",operator:"contains",type:"string",value:""}],onSelectionChange:function(e){return i(e.selected)},enableFiltering:l,multiSelect:!0,checkboxColumn:!0})]})}var V=function(e){var t=e.record;return Object(S.jsxs)("span",{children:["Client ",t?'"'.concat(t.name,'"'):""]})},G=function(e){return Object(S.jsx)(v.a,Object(j.a)(Object(j.a)({},e),{},{children:Object(S.jsxs)(y.a,{children:[Object(S.jsx)(k.a,{source:"name",label:"Name"}),Object(S.jsx)(k.a,{source:"phone",label:"Phone"}),Object(S.jsx)(k.a,{source:"email",label:"Email"}),Object(S.jsx)(k.a,{source:"instagram",label:"Instagram"})]})}))},J=function(e){return Object(S.jsx)(C.a,Object(j.a)(Object(j.a)({title:Object(S.jsx)(V,{})},e),{},{children:Object(S.jsxs)(y.a,{children:[Object(S.jsx)(k.a,{source:"name",label:"Name"}),Object(S.jsx)(k.a,{source:"phone",label:"Phone"}),Object(S.jsx)(k.a,{source:"email",label:"Email"}),Object(S.jsx)(k.a,{source:"instagram",label:"Instagram"})]})}))},z=n(137),H=n(546),K=n(544),X=n(826),Z=n(827),$=n(532),ee=n(828),te=n(404),ne=n(564),ae=n(530),re=n(739),ce=n.n(re),ie=n(207),se=n.n(ie),oe=n(1768),le=n(602),ue=n.n(le),de=n(151),je=n.n(de),be=n(408),pe=n.n(be),fe=n(417),he=n(750),me=(n(1748),{apiKey:"AIzaSyAUqOhdFbfRiCRqSzxKpYeTppBGsHfAAug",authDomain:"admin-a4a00.firebaseapp.com",databaseURL:"https://admin-a4a00-default-rtdb.firebaseio.com",projectId:"admin-a4a00",storageBucket:"admin-a4a00.appspot.com",messagingSenderId:"328849622350",appId:"1:328849622350:web:cf2cd21a20f108e7aeca1f",measurementId:"G-YKBC2Q28P1"});R.a.initializeApp(me);var Oe=R.a.messaging(),xe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:18e5;return new Proxy(e,{get:function(n,a){return function(n,r){return"getOne"===a||"getMany"===a||"getList"===a?e[a](n,r).then((function(e){var n=new Date;return n.setTime(n.getTime()+t),e.validUntil=n,e})):e[a](n,r)}}})}(Object(he.FirebaseDataProvider)(me,{disableMeta:!1})),ge=Object(he.FirebaseAuthProvider)(me),ve=function(){var e=Object(f.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge.checkAuth();case 2:return t=e.sent,e.abrupt("return",t.ya);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye=function(){var e=Object(f.a)(p.a.mark((function e(){var t,a,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n(918),e.next=3,ve();case 3:return a=e.sent,r=JSON.stringify({token:a}),c={method:"post",url:"https://australia-southeast1-admin-a4a00.cloudfunctions.net/getToken",headers:{Authorization:"Basic MkMzRDBFMkMtODQ3Qi00OEI4LUI1NTItOENCQTlDQkEzREQ4OjgwOEFGMDlBLTBFODgtNDU3Mi04QzJGLUUwOEIwOEE4N0RFMQ==","Content-Type":"application/json"},data:r},e.abrupt("return",t(c).then((function(e){return e.data})).catch((function(e){console.log(e)})));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ke=function(){var e=Object(f.a)(p.a.mark((function e(t,n){var a,r,c,i,s,o,l,u,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=R.a.storage(),r=[],c=a.ref(),e.prev=3,i=c.child("attachments/".concat(t)),e.next=7,i.listAll();case 7:s=e.sent,o=Object(fe.a)(s.items),e.prev=9,o.s();case 11:if((l=o.n()).done){e.next=19;break}return u=l.value,e.next=15,u.getDownloadURL();case 15:d=e.sent,r.push(d);case 17:e.next=11;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),o.e(e.t0);case 24:return e.prev=24,o.f(),e.finish(24);case 27:e.next=32;break;case 29:return e.prev=29,e.t1=e.catch(3),e.abrupt("return",!1);case 32:return e.abrupt("return",r);case 33:case"end":return e.stop()}}),e,null,[[3,29],[9,21,24,27]])})));return function(t,n){return e.apply(this,arguments)}}(),Ce=function(){var e=Object(f.a)(p.a.mark((function e(){var t,n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=R.a.storage(),n=t.ref(),a=n.child("attachments"),e.next=5,a.listAll();case 5:return r=(r=e.sent).prefixes.map((function(e){return e.location.path_.split("/")[1]})),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),we=function(){var e=Object(f.a)(p.a.mark((function e(t,n,a){var r,c,i,s,o,l,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=R.a.storage(),c=r.ref(),i=n,e.prev=3,s=Object(fe.a)(a),e.prev=5,s.s();case 7:if((o=s.n()).done){e.next=15;break}return l=o.value,u=c.child("attachments/".concat(t,"/file").concat(i,".jpg")),i++,e.next=13,u.put(l);case 13:e.next=7;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(5),s.e(e.t0);case 20:return e.prev=20,s.f(),e.finish(20);case 23:e.next=27;break;case 25:e.prev=25,e.t1=e.catch(3);case 27:case"end":return e.stop()}}),e,null,[[3,25],[5,17,20,23]])})));return function(t,n,a){return e.apply(this,arguments)}}();Oe.getToken({vapidKey:"BGXh163BEaceHzjq8oIfgZfCnHEze0njY12K3FFlv8N0lLtNYTsKWpE0L7darB0Yiqzt2P_6VCcuHnSvo6beecs"}).then(function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=10;break}return console.log("current token for client: ",t),e.next=4,xe.getList("notifications",{filter:{fcmtoken:t},pagination:{page:1,perPage:1e3}});case 4:if(0!==e.sent.total){e.next=8;break}return e.next=8,xe.create("notifications",{data:{fcmtoken:t}});case 8:e.next=11;break;case 10:console.log("No registration token available. Request permission to generate one.");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log("An error occurred while retrieving token. ",e),Y.NotificationManager.error("Notifications not enabled!","Allow notifications and refresh page",5e5,(function(){alert("callback")}))}));var Se=n(1048),Pe=n.n(Se),De=n(728),Me=n(729),Ne=n(730),Ee=n(731),Ie=n(1046),Ae=n.n(Ie),Te=n(245),Fe=n.n(Te),Le=function(e){return Object(S.jsx)(a.Fragment,{children:Object(S.jsxs)(De.a,{open:e.open,children:[Object(S.jsx)(Me.a,{children:"Upload Pictures"}),Object(S.jsx)(Ne.a,{children:Object(S.jsx)(Ae.a,{withIcon:!0,buttonText:"Choose images",onChange:e.onDrop,imgExtension:[".jpg",".jpeg",".png"],withPreview:!0})}),Object(S.jsxs)(Ee.a,{children:[Object(S.jsx)(x.a,{label:"Cancel",onClick:e.onCancel,children:Object(S.jsx)(Fe.a,{})}),Object(S.jsx)(x.a,{onClick:function(){e.onPicSend(),e.onCancel()},label:"Send",children:Object(S.jsx)(L.a,{})})]})]})})},Ye=n(1047),We=n.n(Ye),_e=n(1766),Be=n(288),Ue=function(e){return Object(S.jsx)(a.Fragment,{children:Object(S.jsxs)(De.a,{open:e.open,children:[Object(S.jsx)(Me.a,{children:"Delete Pictures"}),Object(S.jsx)(Ne.a,{children:Object(S.jsx)(_e.a,{labelId:"demo-simple-select-disabled-label",id:"demo-simple-select-disabled",children:Array(e.length).map((function(e){return Object(S.jsx)(Be.a,{value:e,children:"File".concat(e)})}))})}),Object(S.jsxs)(Ee.a,{children:[Object(S.jsx)(x.a,{label:"Cancel",onClick:e.onCancel,children:Object(S.jsx)(Fe.a,{})}),Object(S.jsx)(x.a,{label:"Delete",children:Object(S.jsx)(We.a,{})})]})]})})},qe=n(178),Re=n.n(qe);function Qe(e){var t=r.a.useState([]),n=Object(h.a)(t,2),a=n[0],c=n[1],i=r.a.useState(!1),s=Object(h.a)(i,2),o=s[0],l=s[1],u=r.a.useState(!1),d=Object(h.a)(u,2),j=d[0],b=d[1],m=r.a.useState(null),O=Object(h.a)(m,2),g=O[0],v=O[1],y=r.a.useState(null),k=Object(h.a)(y,2);k[0],k[1];function C(){return(C=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we(t,a.length,g);case 2:return e.next=4,w();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return P.apply(this,arguments)}function P(){return(P=Object(f.a)(p.a.mark((function t(){var n;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=[],t.next=3,ke(e.record.id,!0);case 3:t.sent.forEach((function(e){var t={};t.src=e,n.push(t)})),c(n);case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return r.a.useEffect((function(){w()}),[]),Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(x.a,{label:"Upload",onClick:function(){return l(!o)},children:Object(S.jsx)(Pe.a,{})}),0!==a.length&&Object(S.jsx)(x.a,{label:"Delete Picture",onClick:function(){return b(!j)},children:Object(S.jsx)(Re.a,{})}),Object(S.jsx)("div",{children:a!==[]&&Object(S.jsx)(pe.a,{images:a})}),Object(S.jsx)(Le,{onDrop:function(e){v(e)},onPicSend:function(){return function(e){return C.apply(this,arguments)}(e.record.id)},open:o,onCancel:function(){l(!o)}}),Object(S.jsx)(Ue,{open:j,onCancel:function(){return b(!j)},length:a.length})]})}window.moment=_.a;n(187);function Ve(e){var t=Object(m.a)(),n=a.useState({}),r=Object(h.a)(n,2),c=r[0],i=r[1],s=a.useState(!1),o=Object(h.a)(s,2),l=o[0],u=o[1],d=a.useState([]),j=Object(h.a)(d,2),b=j[0],v=j[1],y=a.useState(!0),k=Object(h.a)(y,2),C=k[0],w=k[1],P=a.useState(),M=Object(h.a)(P,2),N=M[0],E=(M[1],a.useState({})),A=Object(h.a)(E,2),F=A[0],Y=A[1],W=a.useState(!1),_=Object(h.a)(W,2),B=_[0],q=_[1],R=Object.assign({},D.a.defaultProps.filterTypes,{client:{type:"string",emptyValue:"",operators:[{name:"contains",fn:function(e){var t=e.value,n=e.filterValue;e.data;return!n||t&&-1!=t.name.toLowerCase().indexOf(n.toLowerCase())}}]}}),Q=[{name:"dog_name",header:"Name",defaultWidth:200},{name:"client",header:"Client",defaultWidth:200,filterEditor:ce.a,render:function(e){var t=e.value;e.data;try{return Object(S.jsx)(S.Fragment,{children:Object(S.jsx)("a",{href:"#clients/"+t.id,children:Object(S.jsx)("span",{style:{paddingRight:"5px"},children:t.name})})})}catch(n){return}}},{name:"breed",header:"Breed",defaultWidth:200,render:function(e){var t=e.value;return t&&Object(S.jsx)(oe.a,{color:"primary",style:{backgroundColor:"orange"},label:t},t)}},{name:"vet_email",header:"Vet Email",defaultWidth:200},{name:"vet",header:"Vet",defaultWidth:200},{name:"DaycareAttendee",header:"Daycare Attendee",defaultWidth:150,filterEditor:se.a,render:function(e){return e.value&&Object(S.jsx)(je.a,{htmlColor:"green",style:{textAlign:"center",verticalAlign:"center"}})}},{name:"dogdob",header:"DOB",filterEditor:I.a,defaultWidth:200},{name:"comments",header:"Comments",defaultWidth:200},{name:"sex",header:"Sex",defaultWidth:100,filterEditor:T.a,filterEditorProps:{multiple:!0,wrapMultiple:!1,dataSource:["Male","Female"].map((function(e){return{id:e,label:e}}))}},{name:"desexed",header:"Desexed",defaultWidth:100,render:function(e){return e.value&&Object(S.jsx)(je.a,{htmlColor:"pink",style:{textAlign:"center",verticalAlign:"center"}})},filterEditor:se.a},{name:"PassedTemperamentTrial",header:"Passed Temperament Trial",defaultWidth:150,filterEditor:se.a,render:function(e){return e.value&&Object(S.jsx)(je.a,{htmlColor:"blue",style:{textAlign:"center",verticalAlign:"center"}})}},{name:"kcDue",header:"KC Due",defaultWidth:200,filterEditor:I.a},{name:"c3Due",header:"C3 Due",defaultWidth:200,filterEditor:I.a},{name:"attachments",header:"Attachments",defaultWidth:130,render:function(e){return e.value&&Object(S.jsx)(je.a,{htmlColor:"red",style:{textAlign:"center",verticalAlign:"center"}})}}],V={hidden:[],sortInfo:[],reservedViewportWidth:0,columnOrder:Q.map((function(e){return e.name}))},G=function(){return JSON.parse(localStorage.getItem("state-".concat(e.title)))},J=function(t){localStorage.setItem("state-".concat(e.title),JSON.stringify(t))},X=a.useState(Q),Z=Object(h.a)(X,2),$=Z[0],ee=Z[1];return a.useEffect((function(){var t=localStorage.getItem("state-".concat(e.title))||{};if(0===Object.keys(t).length)Y(V),J(V);else{var n=JSON.parse(t);if(0!=n.hidden.length){var a=$;n.hidden.forEach((function(e){return a.forEach((function(t){t.name==e&&(t.visible=!1)}))})),ee(a)}Y(n)}}),[B]),a.useEffect((function(){function n(){return(n=Object(f.a)(p.a.mark((function n(){var a,r,c,i;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.rows||[],r=Object(z.a)(new Set(a.map((function(e){return e.owner})))),n.next=4,t.getMany("clients",{ids:r,pagination:{page:1,perPage:1e6}});case 4:return c=n.sent,n.next=7,Ce();case 7:i=n.sent,a.forEach((function(e){e.attachments=i.indexOf(e.id)>-1;var t=c.data.findIndex((function(t){return t.id===e.owner}));t>-1&&(e.client=c.data[t])})),v(a),w(!1);case 11:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[e.rows]),C?Object(S.jsx)(H.a,{}):N?Object(S.jsx)(K.a,{}):Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(O.b,{title:e.title}),Object(S.jsxs)("div",{children:[Object(S.jsx)(x.a,{label:"Filters",onClick:function(){return u(!l)},children:Object(S.jsx)(U.a,{})}),1===Object.keys(c).length&&Object(S.jsx)(g.a,{basePath:"/dogs",label:"Edit",record:Object.values(c)[0]}),0!==Object.keys(c).length&&Object(S.jsx)(x.a,{label:"Message Client",children:Object(S.jsx)(L.a,{})})]}),Object(S.jsx)(D.a,{idProperty:"id",columns:$,columnOrder:F.columnOrder,filterTypes:R,dataSource:b,editable:!0,style:{minHeight:550},onColumnOrderChange:function(e){var t=G();t.columnOrder=e,Y(t),J(t)},onColumnVisibleChange:function(e){var t=e.column,n=e.visible,a=G();if(n){var r=a.hidden.find((function(e){return e==t.name}));r&&a.hidden.splice(a.hidden.indexOf(r),1),J(a);var c=$;c.forEach((function(e){e.name==t.name&&(e.visible=!0)})),ee(c),q(!B)}else{!a.hidden.find((function(e){return e==t.name}))&&a.hidden.push(t.name),J(a),q(!B)}},defaultFilterValue:[{name:"dog_name",operator:"contains",type:"string",value:""},{name:"client",operator:"contains",type:"client",value:""},{name:"breed",operator:"contains",type:"string",value:""},{name:"vet_email",operator:"contains",type:"string",value:""},{name:"vet",operator:"contains",type:"string",value:""},{name:"DaycareAttendee",operator:"eq",type:"boolean",value:null},{name:"dogdob",operator:"beforeOrOn",type:"date",value:""},{name:"comments",operator:"contains",type:"string",value:""},{name:"sex",operator:"inlist",type:"select",value:null},{name:"desexed",operator:"eq",type:"boolean",value:null},{name:"PassedTemperamentTrial",operator:"eq",type:"boolean",value:null},{name:"kcDue",operator:"beforeOrOn",type:"date",value:""},{name:"c3Due",operator:"beforeOrOn",type:"date",value:""}],onSelectionChange:function(e){return i(e.selected)},enableFiltering:l,multiSelect:!0,checkboxColumn:!0})]})}var Ge=function(e){var t=e.record;return Object(S.jsxs)("span",{children:["Dog ",t?'"'.concat(t.dog_name,'"'):""]})},Je=function(e){return Object(S.jsx)(C.a,Object(j.a)(Object(j.a)({title:Object(S.jsx)(Ge,{})},e),{},{children:Object(S.jsxs)(X.a,{children:[Object(S.jsxs)(Z.a,{label:"Dog Details",children:[Object(S.jsx)(k.a,{source:"dog_name",label:"Dog Name"}),Object(S.jsx)($.a,{filterToQuery:function(e){return{name:e}},source:"owner",reference:"clients",children:Object(S.jsx)(ee.a,{optionText:"name"})}),Object(S.jsx)(te.a,{source:"sex",choices:[{id:"M",name:"Male"},{id:"F",name:"Female"}],label:"Sex"}),Object(S.jsx)(ne.a,{source:"desexed",options:{checkedIcon:Object(S.jsx)(ue.a,{})}})]}),Object(S.jsxs)(Z.a,{label:"Medical Details",children:[Object(S.jsx)(k.a,{source:"vet",label:"Vet"}),Object(S.jsx)(k.a,{source:"vet_email",label:"Vet Email"}),Object(S.jsx)(ae.a,{source:"kc_due",label:"KC Due",options:{format:"DD/MM/YYYY"}}),Object(S.jsx)(ae.a,{source:"c3_due",label:"C3 Due",options:{format:"DD/MM/YYYY"}}),Object(S.jsx)(ae.a,{source:"c5_due",label:"C5 Due",options:{format:"DD/MM/YYYY"}})]}),Object(S.jsx)(Z.a,{label:"Attachments",children:Object(S.jsx)(Qe,{check:!0})})]})}))},ze=function(e){return Object(S.jsx)(v.a,Object(j.a)(Object(j.a)({},e),{},{children:Object(S.jsxs)(X.a,{children:[Object(S.jsxs)(Z.a,{label:"Dog Details",children:[Object(S.jsx)($.a,{filterToQuery:function(e){return{name:e}},source:"owner",reference:"clients",children:Object(S.jsx)(ee.a,{optionText:"name"})}),Object(S.jsx)(k.a,{source:"dog_name",label:"Dog Name"}),Object(S.jsx)(k.a,{source:"breed",label:"Breed"}),Object(S.jsx)(te.a,{source:"sex",choices:[{id:"M",name:"Male"},{id:"F",name:"Female"}],label:"Sex"}),Object(S.jsx)(ne.a,{source:"desexed",options:{checkedIcon:Object(S.jsx)(ue.a,{})}})]}),Object(S.jsxs)(Z.a,{label:"Medical Details",children:[Object(S.jsx)(k.a,{source:"vet",label:"Vet"}),Object(S.jsx)(k.a,{source:"vet_email",label:"Vet Email"}),Object(S.jsx)(ae.a,{source:"kc_due",label:"KC Due",options:{format:"DD/MM/YYYY"}}),Object(S.jsx)(ae.a,{source:"c3_due",label:"C3 Due",options:{format:"DD/MM/YYYY"}}),Object(S.jsx)(ae.a,{source:"c5_due",label:"C5 Due",options:{format:"DD/MM/YYYY"}})]})]})}))},He=n(603),Ke=n.n(He),Xe=n(614),Ze=n(1808),$e=n(753),et=function(){return Object(S.jsxs)(Xe.a,{children:[Object(S.jsx)(Ze.a,{title:"Welcome to the administration"}),Object(S.jsx)($e.a,{children:"Lorem ipsum sic dolor amet..."})]})},tt=n(1049),nt=n(742),at=n(541),rt=n(59),ct=n(126),it=n(612),st=n(1070),ot=n(1052),lt=n.n(ot),ut=n(1809),dt=n(418),jt=n(419),bt=n(421),pt=n(420),ft=r.a.createContext(),ht=(ft.Consumer,function(e){Object(bt.a)(n,e);var t=Object(pt.a)(n);function n(){var e;Object(dt.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={notifications:[],linkSquareModal:!1,selectedPayments:[]},e.setPayments=function(t){e.setState({selectedPayments:t})},e.openSquareLink=function(){e.setState({linkSquareModal:!e.state.linkSquareModal})},e.setNotifications=function(t){var n=e.state.notifications;n.push(t),e.setState({notifications:n})},e.removeNotif=function(t){e.setState({notifications:e.state.notifications.filter((function(e){return e!==t}))})},e.removeAllMessNotif=function(t){e.setState({notifications:e.state.notifications.filter((function(e){return e.convoItem.sid!==t.sid}))})},e}return Object(jt.a)(n,[{key:"render",value:function(){var e=this.props.children,t=this.state,n=t.notifications,a=t.linkSquareModal,r=t.selectedPayments,c=this.setNotifications,i=this.removeNotif,s=this.removeAllMessNotif,o=this.openSquareLink,l=this.setPayments;return Object(S.jsx)(ft.Provider,{value:{notifications:n,setNotifications:c,removeNotif:i,removeAllMessNotif:s,linkSquareModal:a,openSquareLink:o,selectedPayments:r,setPayments:l},children:e})}}]),n}(r.a.Component)),mt=ft,Ot=n(1051),xt=n.n(Ot),gt=n(1050),vt=n.n(gt),yt=n(30);function kt(e){var t=r.a.useContext(mt),n=t.notifications,a=t.removeNotif,c=r.a.useState(null),i=Object(h.a)(c,2),s=i[0],o=i[1],l=Object(yt.g)();return Object(S.jsx)("div",{children:Object(S.jsxs)(ut.a,{style:{height:"25px",width:"45px"},badgeContent:n.length,color:"error",children:[Object(S.jsx)(ct.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){o(e.currentTarget)},children:Object(S.jsx)(lt.a,{htmlColor:"white"})}),Object(S.jsx)(it.a,{id:"simple-menu",anchorEl:s,keepMounted:!0,open:Boolean(s),onClose:function(){o(null)},children:n.length>0?n.map((function(e){return Object(S.jsxs)(Be.a,{onClick:function(){a(e),l.push("/messenger")},children:[(t=e,"payment"===t.type?Object(S.jsx)(st.a,{children:Object(S.jsx)(vt.a,{fontSize:"small"})}):"message"===t.type?Object(S.jsx)(st.a,{children:Object(S.jsx)(xt.a,{fontSize:"small"})}):void 0),e.message]});var t})):Object(S.jsx)(Be.a,{disabled:!0,children:"All Caught Up"})})]})})}var Ct=Object(w.a)({title:{flex:1,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},spacer:{flex:1}}),wt=function(e){var t=Ct();return Object(S.jsxs)(at.a,Object(j.a)(Object(j.a)({},e),{},{children:[Object(S.jsx)(rt.a,{variant:"h6",color:"inherit",className:t.title,id:"react-admin-title"}),Object(S.jsx)("span",{className:t.spacer}),Object(S.jsx)(kt,{})]}))},St=n(543),Pt=n(342),Dt=n(1804),Mt=n(1755),Nt=n(1806),Et=n(1810),It=n(611),At=n.n(It),Tt=n(202),Ft=n.n(Tt),Lt=n(740),Yt=n.n(Lt),Wt=n(601),_t=n.n(Wt),Bt=n(1053),Ut=n.n(Bt),qt=n(1054),Rt=n.n(qt),Qt=n(1055),Vt=n.n(Qt),Gt=n(356),Jt=n.n(Gt),zt=n(1056),Ht=n.n(zt),Kt=n(751),Xt=n.n(Kt),Zt=n(1057),$t=n.n(Zt),en=Object(w.a)((function(e){return{root:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},nested:{paddingLeft:e.spacing(4)}}}));function tn(e){var t=e.onMenuClick,n=(e.logout,en()),r=a.useState(!1),c=Object(h.a)(r,2),i=c[0],s=c[1],o=a.useState(!1),l=Object(h.a)(o,2),u=l[0],d=l[1],j=a.useState(!1),b=Object(h.a)(j,2),p=b[0],f=b[1];return Object(S.jsxs)(Dt.a,{component:"nav",className:n.root,children:[Object(S.jsx)(St.a,{onClick:t,sidebarIsOpen:i}),Object(S.jsx)(Pt.a,{to:"/clients",primaryText:"Clients",leftIcon:Object(S.jsx)(Yt.a,{}),onClick:t,sidebarIsOpen:i},"clients"),Object(S.jsxs)(Mt.a,{button:!0,onClick:function(){s(!i)},children:[Object(S.jsx)(st.a,{children:Object(S.jsx)(Ke.a,{})}),Object(S.jsx)(Nt.a,{primary:"Dogs"}),i?Object(S.jsx)(At.a,{}):Object(S.jsx)(Ft.a,{})]}),Object(S.jsx)(Et.a,{in:i,timeout:"auto",unmountOnExit:!0,children:Object(S.jsx)(Pt.a,{className:n.nested,disablePadding:!0,to:"/dogs",primaryText:"All Dogs",leftIcon:Object(S.jsx)(_t.a,{}),onClick:t,sidebarIsOpen:i},"dogs")}),Object(S.jsxs)(Mt.a,{button:!0,onClick:function(){d(!u)},children:[Object(S.jsx)(st.a,{children:Object(S.jsx)(Ut.a,{})}),Object(S.jsx)(Nt.a,{primary:"Bookings"}),u?Object(S.jsx)(At.a,{}):Object(S.jsx)(Ft.a,{})]}),Object(S.jsxs)(Et.a,{in:u,timeout:"auto",unmountOnExit:!0,children:[Object(S.jsx)(Pt.a,{className:n.nested,disablePadding:!0,to:"/bookings",primaryText:"All Bookings",leftIcon:Object(S.jsx)(Rt.a,{}),onClick:t,sidebarIsOpen:i},"bookings"),Object(S.jsx)(Pt.a,{className:n.nested,disablePadding:!0,to:"/bookingstoday",primaryText:"Bookings Today",leftIcon:Object(S.jsx)(Jt.a,{}),onClick:t,sidebarIsOpen:i},"bookingstoday"),Object(S.jsx)(Pt.a,{className:n.nested,disablePadding:!0,to:"/todaydaycare",primaryText:"Today Daycare",leftIcon:Object(S.jsx)(Jt.a,{}),onClick:t,sidebarIsOpen:i},"todaydaycare"),Object(S.jsx)(Pt.a,{className:n.nested,disablePadding:!0,to:"/todaygrooming",primaryText:"Today Grooming",leftIcon:Object(S.jsx)(Jt.a,{}),onClick:t,sidebarIsOpen:i},"todaygrooming"),Object(S.jsx)(Pt.a,{className:n.nested,disablePadding:!0,to:"/grooming",primaryText:"Grooming",leftIcon:Object(S.jsx)(Jt.a,{}),onClick:t,sidebarIsOpen:i},"grooming"),Object(S.jsx)(Pt.a,{className:n.nested,disablePadding:!0,to:"/daycare",primaryText:"Daycare",leftIcon:Object(S.jsx)(Jt.a,{}),onClick:t,sidebarIsOpen:i},"daycare"),Object(S.jsx)(Pt.a,{className:n.nested,disablePadding:!0,to:"/services",primaryText:"Services",leftIcon:Object(S.jsx)(Vt.a,{}),onClick:t,sidebarIsOpen:i},"services")]}),Object(S.jsxs)(Mt.a,{button:!0,onClick:function(){f(!p)},children:[Object(S.jsx)(st.a,{children:Object(S.jsx)(Ht.a,{})}),Object(S.jsx)(Nt.a,{primary:"Payments"}),p?Object(S.jsx)(At.a,{}):Object(S.jsx)(Ft.a,{})]}),Object(S.jsxs)(Et.a,{in:p,timeout:"auto",unmountOnExit:!0,children:[Object(S.jsx)(Pt.a,{className:n.nested,disablePadding:!0,to:"/payments",primaryText:"All Payments",leftIcon:Object(S.jsx)(Xt.a,{}),onClick:t,sidebarIsOpen:i},"payments"),Object(S.jsx)(Pt.a,{className:n.nested,disablePadding:!0,to:"/unlinked",primaryText:"Unlinked Square",leftIcon:Object(S.jsx)(Xt.a,{}),onClick:t,sidebarIsOpen:i},"unlinkedsquare")]}),Object(S.jsx)(Pt.a,{to:"/messenger",primaryText:"Messenger",leftIcon:Object(S.jsx)($t.a,{}),onClick:t,sidebarIsOpen:i},"messenger")]})}var nn=function(e){return Object(S.jsx)(nt.a,Object(j.a)(Object(j.a)({},e),{},{menu:tn,appBar:wt}))},an=(n(1543),n(1058)),rn=n.n(an),cn=n(389),sn=n.n(cn),on=n(604),ln=n.n(on),un=n(1059),dn=n.n(un),jn=n(422),bn=n.n(jn);n(1548);window.moment=_.a;var pn=n(187),fn=function(e){Object(bt.a)(n,e);var t=Object(pt.a)(n);function n(e){var a;return Object(dt.a)(this,n),(a=t.call(this,e)).state={rows:[]},a}return Object(jt.a)(n,[{key:"componentDidMount",value:function(){var e=Object(f.a)(p.a.mark((function e(){var t,n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.selected){e.next=8;break}return(t=this.props.selected).sort((function(e,t){return new Date(e.start)-new Date(t.start)})),e.next=5,Promise.all(t.map(function(){var e=Object(f.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe.getManyReference("clients",{filter:{id:t.client_ref||""},pagination:{page:1,perPage:1e6}});case 2:return n=e.sent,t.instagram=n.data[0].instagram?n.data[0].instagram:null,e.next=6,xe.getManyReference("dogs",{filter:{owner:t.client_ref||null},pagination:{page:1,perPage:1e6}});case 6:return a=e.sent,t.breed=a.data[0].breed?a.data[0].breed:null,e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:this.setState({rows:t}),e.next=17;break;case 8:return n=new Date,e.next=11,xe.getList("bookings",{pagination:{page:1,perPage:1e6},filter:{category:"daycare",start:pn(n,"yyyy-mm-dd")}});case 11:return(a=e.sent).data.sort((function(e,t){return new Date(e.start)-new Date(t.start)})),a=a.data,e.next=16,Promise.all(a.map(function(){var e=Object(f.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe.getManyReference("clients",{filter:{id:t.client_ref||""},pagination:{page:1,perPage:1e6}});case 2:return n=e.sent,t.instagram=n.data[0].instagram?n.data[0].instagram:null,e.next=6,xe.getManyReference("dogs",{filter:{owner:t.client_ref||null},pagination:{page:1,perPage:1e6}});case 6:return a=e.sent,t.breed=a.data[0].breed?a.data[0].breed:null,e.abrupt("return",t);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 16:this.setState({rows:a});case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h1",{children:"Daycare Attendance List"}),Object(S.jsxs)("table",{children:[Object(S.jsxs)("thead",{children:[Object(S.jsx)("th",{children:"Time"}),Object(S.jsx)("th",{children:"Client"}),Object(S.jsx)("th",{children:"Dog"}),Object(S.jsx)("th",{children:"Breed"}),Object(S.jsx)("th",{children:"Instagram"})]}),Object(S.jsx)("tbody",{children:Object.keys(this.state.rows).length>0&&Object.values(this.state.rows).map((function(e){return Object(S.jsxs)("tr",{children:[Object(S.jsx)("td",{children:_()(e.start).format("hh:mm A")}),Object(S.jsx)("td",{children:e.name}),Object(S.jsx)("td",{children:e.dogName}),Object(S.jsx)("td",{children:e.breed}),Object(S.jsx)("td",{children:e.instagram})]})}))})]})]})}}]),n}(r.a.PureComponent),hn=function(e){Object(bt.a)(n,e);var t=Object(pt.a)(n);function n(e){var a;return Object(dt.a)(this,n),(a=t.call(this,e)).state={rows:[]},a}return Object(jt.a)(n,[{key:"componentDidMount",value:function(){var e=Object(f.a)(p.a.mark((function e(){var t,n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.props.selected){e.next=8;break}return(t=this.props.selected).sort((function(e,t){return new Date(e.start)-new Date(t.start)})),e.next=5,Promise.all(t.map(function(){var e=Object(f.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe.getManyReference("dogs",{filter:{owner:t.client_ref||null},pagination:{page:1,perPage:1e6}});case 2:return n=e.sent,t.breed=n.data[0].breed?n.data[0].breed:null,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:this.setState({rows:t}),e.next=17;break;case 8:return n=new Date,e.next=11,xe.getList("bookings",{pagination:{page:1,perPage:1e6},filter:{category:"stylist",start:pn(n,"yyyy-mm-dd")}});case 11:return(a=e.sent).data.sort((function(e,t){return new Date(e.start)-new Date(t.start)})),a=a.data,e.next=16,Promise.all(a.map(function(){var e=Object(f.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xe.getManyReference("dogs",{filter:{owner:t.client_ref||null},pagination:{page:1,perPage:1e6}});case 2:return n=e.sent,t.breed=n.data[0].breed?n.data[0].breed:null,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 16:this.setState({rows:a});case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return Object(S.jsxs)("div",{children:[Object(S.jsx)("h1",{children:"Grooming Attendance List"}),Object(S.jsxs)("table",{children:[Object(S.jsxs)("thead",{children:[Object(S.jsx)("th",{children:"Time"}),Object(S.jsx)("th",{children:"Client"}),Object(S.jsx)("th",{children:"Dog"}),Object(S.jsx)("th",{children:"Breed"}),Object(S.jsx)("th",{children:"Service"}),Object(S.jsx)("th",{children:"AddOns"})]}),Object(S.jsx)("tbody",{children:Object.keys(this.state.rows).length>0&&Object.values(this.state.rows).map((function(e){return Object(S.jsxs)("tr",{children:[Object(S.jsx)("td",{children:_()(e.start).format("hh:mm A")}),Object(S.jsx)("td",{children:e.name}),Object(S.jsx)("td",{children:e.dogName}),Object(S.jsx)("td",{children:e.breed}),Object(S.jsx)("td",{children:e.service}),Object(S.jsx)("td",{children:e.addOns.map((function(e){return Object(S.jsxs)(S.Fragment,{children:[e,Object(S.jsx)("br",{})]})}))})]})}))})]})]})}}]),n}(r.a.PureComponent);window.moment=_.a;n(187);function mn(e){var t=Object(m.a)(),n=r.a.useState(e.rows),a=Object(h.a)(n,2),c=a[0],i=a[1],s=r.a.useState({}),o=Object(h.a)(s,2),l=o[0],u=o[1],d=r.a.useState(!1),j=Object(h.a)(d,2),b=j[0],v=j[1],y=r.a.useState(null),k=Object(h.a)(y,2),C=k[0],w=k[1],P=r.a.useRef(),M=r.a.useRef(),N=r.a.useState({}),E=Object(h.a)(N,2),A=E[0],F=E[1],W=r.a.useState(!1),B=Object(h.a)(W,2),q=B[0],R=B[1],Q=function(){var e=Object(f.a)(p.a.mark((function e(n){var a,r,s,o,l,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.value,r=n.columnId,n.rowIndex,s=n.data,e.prev=1,"checkedIn"!==r){e.next=10;break}return(o=c)[o.findIndex((function(e){return e.id===s.id}))].checkedIn=a,i(o),e.next=8,t.update("bookings",{id:s.id,data:{checkedIn:a}});case 8:e.next=24;break;case 10:if("status"!==r){e.next=18;break}return(l=c)[l.findIndex((function(e){return e.id===s.id}))].status=a,i(l),e.next=16,t.update("bookings",{id:s.id,data:{status:a}});case 16:e.next=24;break;case 18:if("groomersCode"!==r){e.next=24;break}return(u=c)[u.findIndex((function(e){return e.id===s.id}))].groomersCode=a,i(u),e.next=24,t.update("bookings",{id:s.id,data:{groomersCode:a}});case 24:e.next=28;break;case 26:e.prev=26,e.t0=e.catch(1);case 28:case"end":return e.stop()}}),e,null,[[1,26]])})));return function(t){return e.apply(this,arguments)}}(),V=[{name:"name",header:"Name",defaultWidth:200,render:function(e){var t=e.value,n=e.data;return n.client_ref?Object(S.jsx)("a",{href:"#clients/"+n.client_ref,children:t}):Object(S.jsx)("span",{children:t})},editable:!1},{name:"dogName",header:"Dog",defaultWidth:150,render:function(e){var t=e.value,n=e.data;return n.dog_ref?Object(S.jsx)("a",{href:"#dogs/"+n.dog_ref,children:t}):Object(S.jsx)("span",{children:t})},editable:!1},{name:"status",header:"Status",defaultWidth:101,filterEditor:T.a,filterEditorProps:{multiple:!0,wrapMultiple:!1,dataSource:[{id:"cancelled",label:"Cancelled"},{id:"confirmed",label:"Confirmed"},{id:"modified",label:"Modified"}]},render:function(e){var t=e.value;e.data;return"confirmed"===t?Object(S.jsx)(oe.a,{color:"primary",style:{backgroundColor:"green"},label:"Confirmed"},t):"modified"===t?Object(S.jsx)(oe.a,{color:"primary",style:{backgroundColor:"orange"},label:"Modified"},t):"cancelled"===t?Object(S.jsx)(oe.a,{color:"primary",style:{backgroundColor:"red"},label:"Cancelled"},t):void 0},editor:rn.a,editorProps:{idProperty:"id",dataSource:[{id:"cancelled",label:"Cancelled"},{id:"modified",label:"Modified"},{id:"confirmed",label:"Confirmed"}],collapseOnSelect:!0,clearIcon:null}},{name:"dogData",header:"Breed",defaultWidth:200,editable:!1,render:function(e){var t=e.value;try{return t.breed&&Object(S.jsx)(oe.a,{color:"primary",style:{backgroundColor:"orange"},label:t.breed},t.breed)}catch(n){}}},{name:"groomersCode",header:"Groomer's Code",defaultWidth:100},{name:"checkedIn",header:"Checked In",width:100,filterEditor:se.a,render:function(e){return e.value?Object(S.jsx)(je.a,{htmlColor:"green",style:{textAlign:"center",verticalAlign:"center"}}):null},editor:ln.a},{name:"service",header:"Service",defaultWidth:250,filterEditor:T.a,filterEditorProps:{multiple:!0,wrapMultiple:!1,dataSource:t.getList("services",{pagination:{page:1,perPage:1e5}}).then((function(e){return e.data.map((function(e){return{id:e.service,label:"".concat(e.service,"-").concat(e.category)}}))}))},editable:!1},{name:"category",header:"Category",defaultWidth:150,filterEditor:T.a,filterEditorProps:{multiple:!0,wrapMultiple:!1,dataSource:t.getList("services",{pagination:{page:1,perPage:1e5}}).then((function(e){return Object(z.a)(new Set(e.data.map((function(e){return e.category})))).map((function(e){return{id:e,label:e}}))}))},editable:!1},{name:"deposit",header:"Deposit",defaultWidth:110,filterEditor:se.a,editable:!1,render:function(e){var t=e.value,n=e.data;if(t)return Object(S.jsxs)(S.Fragment,{children:[" ",Object(S.jsx)(je.a,{htmlColor:"blue",style:{textAlign:"center",verticalAlign:"center"}})," ",Object(S.jsx)("span",{children:n.depositAmount})]})}},{name:"date",header:"Booking Date",defaultWidth:138,filterEditor:I.a,filterEditorProps:function(e,t){return{dateFormat:"ddd DD/MM/YYYY",placeholder:1===t.index?"Bookings date is before...":"Booking date is on..."}},render:function(e){var t=e.value;e.cellProps.dateFormat;return _()(t).format("ddd DD/MM/YYYY")},editable:!1},{name:"start",header:"Start Time",defaultWidth:150,filterEditor:I.a,filterEditorProps:function(e,t){return{dateFormat:"ddd DD/MM/YYYY",placeholder:1===t.index?"Bookings date is before...":"Booking date is on..."}},render:function(e){var t=e.value;e.data;return"".concat(_()(t).format("hh:mm A"))}},{name:"addOns",header:"AddOns",defaultWidth:180,render:function(e){var t=e.value;try{return 0!==t.length?Object(S.jsx)(S.Fragment,{children:t.map((function(e){return Object(S.jsx)(oe.a,{color:"secondary",label:e},e)}))}):Object(S.jsx)("span",{})}catch(n){}},cellDOMProps:function(e){e.data;var t=e.value;try{if(t.length>2)return{onMouseEnter:function(){Y.NotificationManager.success(t.map((function(e){return Object(S.jsxs)(S.Fragment,{children:[e,Object(S.jsx)("br",{})]})})),"Extras",5e3,(function(){alert(t.map((function(e){return"".concat(e,"\n")})))}))}}}catch(n){}},editable:!1},{name:"code",header:"Booking Code",defaultWidth:110,editable:!1}],G={hidden:[],sortInfo:[],reservedViewportWidth:0,columnOrder:V.map((function(e){return e.name}))},J=function(){return JSON.parse(localStorage.getItem("state-".concat(e.title)))},H=function(t){localStorage.setItem("state-".concat(e.title),JSON.stringify(t))},K=r.a.useState(V),X=Object(h.a)(K,2),Z=X[0],$=X[1];return r.a.useEffect((function(){var t=localStorage.getItem("state-".concat(e.title))||{};if(0===Object.keys(t).length)F(G),H(G);else{var n=JSON.parse(t);if(0!=n.hidden.length){var a=Z;n.hidden.forEach((function(e){return a.forEach((function(t){t.name==e&&(t.visible=!1)}))})),$(a)}F(n)}}),[q]),r.a.useEffect((function(){function n(){return(n=Object(f.a)(p.a.mark((function n(){var a,r,c,s,o;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=[],r=[],e.rows&&e.rows.forEach((function(e){e.payment_ref&&e.payment_ref.forEach((function(e){a.push(e)})),e.dog_ref&&r.push(e.dog_ref)})),r=Object(z.a)(new Set(r.map((function(e){return e})))),a=Object(z.a)(new Set(a.map((function(e){return e})))),n.next=7,t.getMany("payments",{ids:a,pagination:{page:1,perPage:1e6}});case 7:return c=n.sent,n.next=10,t.getMany("dogs",{ids:r,pagination:{page:1,perPage:1e6}});case 10:s=n.sent,(o=e.rows||[]).forEach((function(e){if(e.date=e.start.substring(0,10),e.payment_ref){var t=[];e.payment_ref.forEach((function(e){t.push(c.data.filter((function(t){return t.id===e}))[0])}));var n,a=!1;t.forEach((function(e){e.deposit&&(n="$"+e.amount/100,a=!0)})),e.deposit=a,e.depositAmount=n,e.paymentData=t}e.dogData=s.data[s.data.findIndex((function(t){return t.id===e.dog_ref}))]})),i(o);case 14:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[e.rows]),Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(O.b,{title:e.title}),Object(S.jsxs)("div",{children:[Object(S.jsx)(x.a,{label:"Filters",onClick:function(){return v(!b)},children:Object(S.jsx)(U.a,{})}),Object(S.jsx)(x.a,{label:"Print",onClick:function(e){w(e.currentTarget)},children:Object(S.jsx)(dn.a,{})}),Object(S.jsxs)(it.a,{id:"simple-menu",anchorEl:C,keepMounted:!0,open:Boolean(C),onClose:function(){w(null)},children:[Object(S.jsx)(bn.a,{content:function(){return P.current},children:Object(S.jsx)(jn.PrintContextConsumer,{children:function(t){var n=t.handlePrint;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(Be.a,{onClick:n,children:"Daycare Attendance List"}),Boolean(C)&&Object(S.jsx)("div",{style:{display:"none"},children:Object(S.jsx)(fn,{ref:P,selected:"Daycare Today"===e.title&&c})})]})}})}),Object(S.jsx)(bn.a,{content:function(){return M.current},children:Object(S.jsx)(jn.PrintContextConsumer,{children:function(t){var n=t.handlePrint;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(Be.a,{onClick:n,children:"Grooming Attendance List"}),Boolean(C)&&Object(S.jsx)("div",{style:{display:"none"},children:Object(S.jsx)(hn,{ref:M,selected:"Grooming Today"===e.title&&c})})]})}})})]}),1===Object.keys(l).length&&Object(S.jsx)(g.a,{basePath:"/bookings",label:"Edit",record:Object.values(l)[0]}),1===Object.keys(l).length&&Object(S.jsx)(x.a,{label:"Charge card",children:Object(S.jsx)(sn.a,{})}),0!==Object.keys(l).length&&Object(S.jsx)(x.a,{label:"Message Owners",children:Object(S.jsx)(L.a,{})})]}),Object(S.jsx)(D.a,{idProperty:"id",columns:Z,columnOrder:A.columnOrder,dataSource:c,style:{minHeight:550},onEditComplete:Q,editable:!0,defaultFilterValue:[{name:"date",operator:"eq",type:"date",value:""},{name:"service",operator:"inlist",type:"select",value:null},{name:"status",operator:"inlist",type:"select",value:null},{name:"category",operator:"inlist",type:"select",value:null},{name:"checkedIn",operator:"eq",type:"boolean",value:null},{name:"code",operator:"contains",type:"string",value:""},{name:"dogName",operator:"contains",type:"string",value:""},{name:"name",operator:"contains",type:"string",value:""},{name:"deposit",operator:"eq",type:"boolean",value:null},{name:"groomersCode",operator:"contains",type:"string",value:""}],onSelectionChange:function(e){return u(e.selected)},enableFiltering:b,onSortInfoChange:function(e){var t=J();t.sortInfo=e,F(t),H(t)},onColumnOrderChange:function(e){var t=J();t.columnOrder=e,F(t),H(t)},onColumnVisibleChange:function(e){var t=e.column,n=e.visible,a=J();if(n){var r=a.hidden.find((function(e){return e==t.name}));r&&a.hidden.splice(a.hidden.indexOf(r),1),H(a);var c=Z;c.forEach((function(e){e.name==t.name&&(e.visible=!0)})),$(c),R(!q)}else{!a.hidden.find((function(e){return e==t.name}))&&a.hidden.push(t.name),H(a),R(!q)}},multiSelect:!0,checkboxColumn:!0})]})}var On=n(143);window.moment=_.a;var xn=n(187);window.moment=_.a;var gn=n(187);window.moment=_.a;var vn=n(187);n(1549);function yn(e){return Object(S.jsx)("div",{className:"conversation-search",children:Object(S.jsx)("input",{type:"search",className:"conversation-search-input",placeholder:"Search Client",onChange:function(t){return e.searchFilterFunction(t.target.value)},value:e.searchText})})}var kn=n(1060);n(1550);function Cn(e){Object(a.useEffect)((function(){Object(kn.a)(".conversation-snippet",20)}));var t=e.data,n=(t.photo,t.name),r=t.text,c=t.unreadCount;return Object(S.jsx)("div",{className:"conversation-list-item",onClick:function(){e.onClick({sid:e.data.sid,name:e.data.name})},children:Object(S.jsxs)("div",{className:"conversation-info",children:[Object(S.jsx)("h1",{className:"conversation-title",children:n}),Object(S.jsxs)("p",{className:"conversation-snippet",children:[r,0!==c&&Object(S.jsx)("text",{className:"badge",children:c})]})]})})}n(1551);function wn(e){var t=e.title,n=e.leftItems,a=e.rightItems;return Object(S.jsxs)("div",{className:"toolbar",children:[Object(S.jsx)("div",{className:"left-items",children:n}),Object(S.jsx)("h1",{className:"toolbar-title",children:t}),Object(S.jsx)("div",{className:"right-items",children:a})]})}n(1552);function Sn(e){var t=e.icon;return Object(S.jsx)("i",{className:"toolbar-button ".concat(t)})}var Pn=n(1061),Dn=n.n(Pn),Mn=n(610),Nn=Object(w.a)((function(e){return{root:{width:"100%",height:500,maxWidth:300,backgroundColor:e.palette.background.paper}}}));function En(e){var t=Object(m.a)(),n=Nn(),r=Object(a.useState)([]),c=Object(h.a)(r,2),i=c[0],s=c[1],o=Object(a.useState)([]),l=Object(h.a)(o,2),u=l[0],d=l[1],j=Object(a.useState)(""),b=Object(h.a)(j,2),O=b[0],g=b[1],v=Object(a.useState)(""),y=Object(h.a)(v,2),k=y[0],C=y[1],w=Object(a.useState)(!0),P=Object(h.a)(w,2),D=P[0],M=P[1];Object(a.useEffect)((function(){function e(){return(e=Object(f.a)(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getList("clients",{pagination:{page:1,perPage:1e4}});case 2:n=e.sent,g(n.total),s(n.data),d(n.data),M(!1);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var N=function(t){var n=e.activeConvos.filter((function(e){return e.text===t.phone}));n.length>0?(e.setActiveConvo({sid:n[0].sid,name:n[0].name}),e.open(!e.visible)):(e.createNewConvo(t.phone,t.name),e.open(!e.visible))};return D?Object(S.jsx)(H.a,{}):Object(S.jsx)(a.Fragment,{children:Object(S.jsxs)(De.a,{open:e.visible,children:[Object(S.jsx)(Me.a,{children:"Create new Conversation"}),Object(S.jsx)(Ne.a,{children:Object(S.jsxs)("div",{className:n.root,children:[Object(S.jsx)(yn,{searchText:k,searchFilterFunction:function(e){var t=u.filter((function(t){var n;try{n=t.name.toUpperCase()}catch(c){n=null}var a="".concat(n),r=e.toUpperCase();return a.indexOf(r)>-1}));C(e),s(t),g(t.length)}}),Object(S.jsx)(Mn.a,{height:400,width:300,itemSize:46,itemCount:O,children:function(e){var t=e.index,n=e.style;return Object(S.jsx)(Mt.a,{onClick:Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",N(i[t]));case 1:case"end":return e.stop()}}),e)}))),button:!0,style:n,children:Object(S.jsx)(Nt.a,{primary:i[t].name})},t)}})]})}),Object(S.jsx)(Ee.a,{children:Object(S.jsx)(x.a,{label:"Cancel",onClick:function(){return e.open(!e.visible)},children:Object(S.jsx)(Fe.a,{})})})]})})}n(1553);var In=n(1554);function An(e){var t=Object(m.a)(),n=Object(a.useContext)(mt),r=(n.notifications,n.setNotifications),c=n.removeAllMessNotif,i=Object(a.useState)([]),s=Object(h.a)(i,2),o=s[0],l=s[1],u=Object(a.useState)([]),d=Object(h.a)(u,2),j=d[0],b=d[1],O=Object(a.useState)(null),g=Object(h.a)(O,2),v=g[0],y=g[1],k=Object(a.useState)(!1),C=Object(h.a)(k,2),w=C[0],P=C[1];Object(a.useEffect)((function(){T()}),[]);var D=function(e,t){var n=t.filter((function(t){return t.text===e.conversation.channelState.uniqueName.split(":")[1]}))[0];Y.NotificationManager.info(n.name,"New message",3e3),r({message:"Message from ".concat(n.name),type:"message",convoItem:n})},M=Object(a.useCallback)(function(){var e=Object(f.a)(p.a.mark((function e(n,a){var r,c,i,s,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=17;break}return i=function(){return(i=Object(f.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.hasNextPage){e.next=7;break}return e.next=3,t.nextPage();case 3:return n=e.sent,r=r.concat(n.items),e.next=7,c(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)},c=function(e){return i.apply(this,arguments)},r=[],e.next=6,n.getSubscribedConversations();case 6:return s=e.sent,r=s.items,e.next=10,c(s);case 10:return e.next=12,Promise.all(r.map(function(){var e=Object(f.a)(p.a.mark((function e(n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getList("clients",{filter:{phone:n.channelState.friendlyName.split(":")[1]},pagination:{page:1,perPage:1}});case 2:return a=e.sent,e.abrupt("return",{name:a.data[0]?a.data[0].name:n.channelState.friendlyName.split(":")[1],text:a.data[0]?a.data[0].phone:n.channelState.friendlyName.split(":")[1],dateUpdated:n.lastMessage?n.lastMessage.dateCreated:n.dateUpdated,sid:n.sid,unreadCount:n.lastMessage?n.lastMessage.index-n.channelState.lastReadMessageIndex:0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 12:(u=e.sent).sort((function(e,t){return new Date(t.dateUpdated)-new Date(e.dateUpdated)})),l([].concat(Object(z.a)(o),Object(z.a)(u))),b(u),a&&D(a,u);case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[o]),N=function(){var e=Object(f.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("token about to expire"),e.next=3,ye();case 3:n=e.sent,t.updateToken(n),console.log("client's token updated");case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function E(e,t){return I.apply(this,arguments)}function I(){return(I=Object(f.a)(p.a.mark((function t(n,a){var r,c,i,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=function(){return(i=Object(f.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.hasNextPage){e.next=7;break}return e.next=3,t.nextPage();case 3:return n=e.sent,r=r.concat(n.items),e.next=7,c(n);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)},c=function(e){return i.apply(this,arguments)},r=[],t.next=5,In.Client.create(n);case 5:(s=t.sent).addListener("tokenAboutToExpire",(function(){return N(s)})),s.addListener("connectionStateChanged",function(){var t=Object(f.a)(p.a.mark((function t(n){var i;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("connected"!==n){t.next=10;break}return t.next=3,s.getSubscribedConversations();case 3:return i=t.sent,r=i.items,t.next=7,c(i);case 7:e.setClient(s),2===s._eventsCount&&(s.addListener("messageAdded",(function(e){return M(s,e)})),s.addListener("conversationRemoved",(function(){return M(s)})),s.addListener("conversationAdded",(function(e){return M(s,e)}))),a(r);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var A=function(){var t=Object(f.a)(p.a.mark((function t(n,a){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.client.createConversation({friendlyName:"pBjefCCX5JXw6QbYFu2GR7rmouw1:"+n,uniqueName:"pBjefCCX5JXw6QbYFu2GR7rmouw1:"+n});case 2:return r=t.sent,t.next=5,r.addNonChatParticipant("+61488844176",n);case 5:return t.next=7,r.add("pBjefCCX5JXw6QbYFu2GR7rmouw1");case 7:e.setactiveConvo({sid:r.sid,name:a});case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),T=function(){var e=Object(f.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ye();case 2:E(e.sent,function(){var e=Object(f.a)(p.a.mark((function e(n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map(function(){var e=Object(f.a)(p.a.mark((function e(n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getList("clients",{filter:{phone:n.channelState.friendlyName.split(":")[1]},pagination:{page:1,perPage:1}});case 2:return a=e.sent,e.abrupt("return",{name:a.data[0]?a.data[0].name:n.channelState.friendlyName.split(":")[1],text:a.data[0]?a.data[0].phone:n.channelState.friendlyName.split(":")[1],dateUpdated:n.lastMessage?n.lastMessage.dateCreated:n.dateUpdated,sid:n.sid,unreadCount:n.lastMessage?n.lastMessage.index-n.channelState.lastReadMessageIndex:0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:(a=e.sent).sort((function(e,t){return new Date(t.dateUpdated)-new Date(e.dateUpdated)})),l([].concat(Object(z.a)(o),Object(z.a)(a))),b(a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=function(t){e.setactiveConvo(t),c(t),o[o.findIndex((function(e){return e.sid===t.sid}))].unreadCount=0,j[j.findIndex((function(e){return e.sid===t.sid}))].unreadCount=0,l(o),b(j)};return Object(S.jsxs)("div",{className:"conversation-list",children:[Object(S.jsx)(wn,{title:"Messenger",leftItems:[Object(S.jsx)(Sn,{icon:"ion-ios-cog"},"cog")],rightItems:[Object(S.jsx)(x.a,{onClick:function(){return P(!w)},children:Object(S.jsx)(Dn.a,{})}),Object(S.jsx)(Sn,{icon:"ion-ios-add-circle-outline"},"add")]}),Object(S.jsx)(yn,{searchFilterFunction:function(e){var t=j.filter((function(t){var n,a;try{n=t.name.toUpperCase()}catch(i){n=null}try{a=t.phone}catch(s){a=null}var r="".concat(n," ").concat(a),c=e.toUpperCase();return r.indexOf(c)>-1}));y(e),l(t)},searchText:v}),o.map((function(e){return Object(S.jsx)(Cn,{data:e,onClick:F},e.sid)})),w&&Object(S.jsx)(En,{visible:w,open:P,activeConvos:o,setActiveConvo:e.setactiveConvo,createNewConvo:A})]})}var Tn=n(1062),Fn=n.n(Tn),Ln=(n(1741),n(1064));function Yn(e){var t=Object(a.useState)(!1),n=Object(h.a)(t,2),r=n[0],c=n[1];return Object(S.jsxs)("div",{className:"compose",children:[Object(S.jsx)(Ln.a,{type:"text",className:"compose-input",placeholder:"Type a message",value:e.value,onChange:function(t){e.onChange(t.target.value)},spellCheck:!0,minRows:"2"}),e.value?Object(S.jsx)(x.a,{onClick:function(){return e.onSend()},children:Object(S.jsx)(L.a,{})}):Object(S.jsx)(x.a,{onClick:function(){return c(!r)},children:Object(S.jsx)(Fn.a,{})}),Object(S.jsx)(Le,{open:r,onCancel:function(){return c(!r)},onDrop:e.onDrop,onPicSend:e.onPicSend}),e.rightItems]})}n(1742);function Wn(e){var t=e.data,n=e.isMine,a=e.startsSequence,r=e.endsSequence,c=e.showTimestamp,i=new RegExp("^https://bit.ly/"),s=_()(t.timestamp).format("LLLL");return Object(S.jsxs)("div",{className:["message","".concat(n?"mine":""),"".concat(a?"start":""),"".concat(r?"end":"")].join(" "),children:[c&&Object(S.jsx)("div",{className:"timestamp",children:s}),Object(S.jsx)("div",{className:"bubble-container",children:Object(S.jsx)("div",{className:"bubble",title:s,children:i.test(t.message)?Object(S.jsx)(pe.a,{thumbnailWidth:"150px",thumbnailHeight:"150px",images:[{src:t.message}]}):t.message})})]})}var _n=n(918),Bn=function(){var e=Object(f.a)(p.a.mark((function e(t,n){var a,r,c,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=function(e){return new Promise((function(t,n){var a=new FileReader;a.onload=function(e){return t(a.result)},a.onerrror=n,a.readAsDataURL(e)}))},e.next=3,a(n);case 3:return r=e.sent,c=JSON.stringify({token:t,image:r.replace("data:","").replace(/^.*;base64,/,"")}),i={method:"post",url:"https://australia-southeast1-admin-a4a00.cloudfunctions.net/adminPicUploader",headers:{Authorization:"Basic ODU2NzZCNUEtOEE5MS00NzYwLUE4MTctODQ2MUIyQ0I3MTI0OjZCQ0FGQUY5LUVFQ0YtNDRBNi04QTBBLTg3RjFDQUYxQTQxNg==","Content-Type":"application/json"},data:c},e.abrupt("return",_n(i).then((function(e){return e.data})).catch((function(e){return e})));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();n(1743);function Un(e){var t=Object(a.useState)([]),n=Object(h.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(null),s=Object(h.a)(i,2),o=s[0],l=s[1],u=Object(a.useState)(null),d=Object(h.a)(u,2),j=d[0],b=d[1],m=Object(a.useRef)(null),O=Object(a.useState)(null),x=Object(h.a)(O,2),g=x[0],v=x[1],y=function(){var e=Object(f.a)(p.a.mark((function e(){var t,n,a,r,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve();case 2:t=e.sent,n=Object(fe.a)(g),e.prev=4,n.s();case 6:if((a=n.n()).done){e.next=15;break}return r=a.value,e.next=10,Bn(t,r);case 10:return c=e.sent,e.next=13,C(c);case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(4),n.e(e.t0);case 20:return e.prev=20,n.f(),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[4,17,20,23]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){!function(){var e;null===(e=m.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}()}),[r]);var k=Object(a.useCallback)(Object(f.a)(p.a.mark((function t(){var n,a,r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=[],!e.activeConvo){t.next=12;break}return t.next=4,e.client.getConversationBySid(e.activeConvo.sid);case 4:return 0===(a=t.sent)._events.messageAdded.length&&a.addListener("messageAdded",k),a.channelState.lastMessage&&a.advanceLastReadMessageIndex(a.channelState.lastMessage.index),b(a),t.next=10,a.getMessages();case 10:r=t.sent,n=r.items.map((function(e){return{id:e.state.index,author:e.state.author,message:e.state.body,timestamp:e.state.timestamp}}));case 12:c(n);case 13:case"end":return t.stop()}}),t)}))),[e.activeConvo,e.client]);Object(a.useEffect)((function(){return k(),function(){j&&j.removeListener("messageAdded",k)}}),[j,k,e.activeConvo,e.client]);var C=function(){var e=Object(f.a)(p.a.mark((function e(t){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.sendMessage(t||o);case 2:return e.next=4,j.getMessages();case 4:n=e.sent,a=n.items.map((function(e){return{id:e.state.index,author:e.state.author,message:e.state.body,timestamp:e.state.timestamp}})),l(""),c(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(S.jsxs)("div",{className:"message-list",children:[Object(S.jsx)(wn,{title:e.activeConvo?e.activeConvo.name:"Select a conversation",rightItems:[Object(S.jsx)(Sn,{icon:"ion-ios-information-circle-outline"},"info"),Object(S.jsx)(Sn,{icon:"ion-ios-videocam"},"video"),Object(S.jsx)(Sn,{icon:"ion-ios-call"},"phone")]}),Object(S.jsxs)("div",{className:"message-list-container",children:[function(){for(var e=0,t=r.length,n=[];e<t;){var a=r[e-1],c=r[e],i=r[e+1],s="pBjefCCX5JXw6QbYFu2GR7rmouw1"===c.author,o=_()(c.timestamp),l=!0,u=!0,d=!0;if(a){var j=_()(a.timestamp),b=_.a.duration(o.diff(j));a.author===c.author&&b.as("hours")<1&&(l=!1),b.as("hours")<1&&(d=!1)}if(i){var p=_()(i.timestamp),f=_.a.duration(p.diff(o));i.author===c.author&&f.as("hours")<1&&(u=!1)}n.push(Object(S.jsx)(Wn,{isMine:s,startsSequence:l,endsSequence:u,showTimestamp:d,data:c},e)),e+=1}return n}(),Object(S.jsx)("div",{ref:m})]}),Object(S.jsx)(Yn,{value:o,onChange:l,onSend:C,onPicSend:y,onDrop:v,rightItems:[Object(S.jsx)(Sn,{icon:"ion-ios-camera"},"photo"),Object(S.jsx)(Sn,{icon:"ion-ios-image"},"image"),Object(S.jsx)(Sn,{icon:"ion-ios-mic"},"audio"),Object(S.jsx)(Sn,{icon:"ion-ios-card"},"money"),Object(S.jsx)(Sn,{icon:"ion-logo-game-controller-b"},"games"),Object(S.jsx)(Sn,{icon:"ion-ios-happy"},"emoji")]})]})}n(1744);function qn(e){var t=Object(a.useState)(null),n=Object(h.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(null),s=Object(h.a)(i,2),o=s[0],l=s[1];return Object(S.jsxs)("div",{className:"messenger",children:[Object(S.jsx)("div",{className:"scrollable sidebar",children:Object(S.jsx)(An,{setactiveConvo:c,setClient:l,client:o})}),Object(S.jsx)("div",{className:"scrollable content",children:Object(S.jsx)(Un,{activeConvo:r,client:o})})]})}var Rn=n(1757),Qn=n(606),Vn=n(605),Gn=n.n(Vn),Jn=n(1063),zn=n.n(Jn);window.moment=_.a;var Hn=n(187),Kn=Object(w.a)((function(e){return{root:{width:"100%",height:600,maxWidth:450,backgroundColor:e.palette.background.paper}}}));function Xn(e){Object(yt.g)();var t=Object(m.a)(),n=Kn(),c=Object(a.useContext)(mt),i=c.linkSquareModal,s=c.openSquareLink,o=c.selectedPayments,l=Object(a.useState)([]),u=Object(h.a)(l,2),d=u[0],j=u[1],b=Object(a.useState)([]),O=Object(h.a)(b,2),g=O[0],v=O[1],y=Object(a.useState)(""),k=Object(h.a)(y,2),C=k[0],w=k[1],P=Object(a.useState)(""),D=Object(h.a)(P,2),M=D[0],N=D[1],E=Object(a.useState)(!0),I=Object(h.a)(E,2),A=I[0],T=I[1],F=r.a.useState([]),L=Object(h.a)(F,2),Y=L[0],W=L[1],_=r.a.useState(!0),B=Object(h.a)(_,2),U=B[0],q=B[1];Object(a.useEffect)((function(){function e(){return(e=Object(f.a)(p.a.mark((function e(){var n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(T(!0),n=new Date,!U){e.next=8;break}return e.next=5,t.getList("bookings",{filter:{start:Hn(n,"yyyy-mm-dd")},pagination:{page:1,perPage:1e4}});case 5:a=e.sent,e.next=11;break;case 8:return e.next=10,t.getList("bookings",{pagination:{page:1,perPage:1e4}});case 10:a=e.sent;case 11:a.data.forEach((function(e){e.date=e.start.substring(0,10)})),w(a.total),j(a.data),v(a.data),T(!1);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[U]);var R=function(){var n=Object(f.a)(p.a.mark((function n(){var a,r;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=o,r=Y.map((function(e){return e.id})),n.next=4,t.updateMany("payments",{ids:a,data:{booking_ref:r,linked:!0}});case 4:return n.next=6,t.updateMany("bookings",{ids:r,data:{payment_ref:a}});case 6:W([]),e.refetch(),s();case 9:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return A?Object(S.jsx)(H.a,{}):Object(S.jsx)(a.Fragment,{children:Object(S.jsxs)(De.a,{open:i,children:[Object(S.jsx)(Me.a,{children:"Link Square payment with booking"}),Object(S.jsxs)(Ne.a,{children:[Object(S.jsx)(Rn.a,{children:'Search "Client Dog YYYY-MM-DD"'}),Object(S.jsxs)("div",{className:n.root,children:[Object(S.jsx)(yn,{searchText:M,searchFilterFunction:function(e){var t=g.filter((function(t){var n,a,r;try{n=t.name.toUpperCase()}catch(s){n=null}try{a=t.dogName.toUpperCase()}catch(o){n=null}try{r=t.date.toUpperCase()}catch(l){r=null}var c="".concat(n," ").concat(a," ").concat(r),i=e.toUpperCase();return c.indexOf(i)>-1}));N(e),j(t),w(t.length)}}),Object(S.jsx)(Mn.a,{height:550,width:450,itemSize:60,itemCount:C,children:function(e){var t,n=e.index,a=e.style;return Object(S.jsxs)(Mt.a,{button:!0,style:a,children:[Object(S.jsx)(Nt.a,{primary:"".concat(d[n].name," - ").concat(d[n].dogName),secondary:"".concat(d[n].service," - ").concat(d[n].date)}),Object(S.jsx)(Qn.a,{edge:"end",onChange:(t=d[n],function(){var e=Y.indexOf(t),n=Object(z.a)(Y);-1===e?n.push(t):n.splice(e,1),W(n)}),checked:-1!==Y.indexOf(d[n])})]},n)}})]})]}),Object(S.jsxs)(Ee.a,{children:[Object(S.jsx)(x.a,{label:U?"Today":"All",onClick:function(){return q(!U)},children:Object(S.jsx)(zn.a,{})}),0!==Y.length&&Object(S.jsx)(x.a,{label:"Link",onClick:function(){return R()},children:Object(S.jsx)(Gn.a,{})}),Object(S.jsx)(x.a,{label:"Cancel",onClick:function(){return s()},children:Object(S.jsx)(Fe.a,{})})]})]})})}window.moment=_.a;n(187);function Zn(e){var t=Object(m.a)(),n=a.useState({}),r=Object(h.a)(n,2),c=r[0],i=r[1],s=a.useState(!1),o=Object(h.a)(s,2),l=o[0],u=o[1],d=a.useState([]),j=Object(h.a)(d,2),b=j[0],v=j[1],y=a.useState(!0),k=Object(h.a)(y,2),C=k[0],w=k[1],P=a.useState(),M=Object(h.a)(P,2),E=M[0],I=(M[1],a.useContext(mt)),A=I.linkSquareModal,F=I.openSquareLink,Y=I.setPayments,W=function(){var e=Object(f.a)(p.a.mark((function e(n){var a,r,c,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.value,r=n.columnId,n.rowIndex,c=n.data,e.prev=1,"deposit"!==r){e.next=8;break}return(i=b)[i.findIndex((function(e){return e.id===c.id}))].deposit=a,v(i),e.next=8,t.update("payments",{id:c.id,data:{deposit:a}});case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(1);case 12:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),_=[{name:"description",header:"Description",defaultWidth:200,editable:!1},{name:"status",header:"Status",defaultWidth:130,filterEditor:T.a,editable:!1,filterEditorProps:{multiple:!0,wrapMultiple:!1,dataSource:["succeeded","failed"].map((function(e){return{id:e,label:e.charAt(0).toUpperCase()+e.slice(1)}}))},render:function(e){var t=e.value;return"succeeded"===t?Object(S.jsx)(oe.a,{color:"primary",style:{backgroundColor:"green"},label:"Suceeded"},t):"failed"===t?Object(S.jsx)(oe.a,{color:"primary",style:{backgroundColor:"red"},label:"Failed"},t):void 0}},{name:"name",editable:!1,header:"Name",defaultWidth:200,render:function(e){var t=e.value,n=e.data;try{return Object(S.jsx)("a",{href:"#clients/"+n.bookingData[0].client_ref,children:Object(S.jsx)("span",{style:{paddingRight:"5px"},children:t})})}catch(a){return t}}},{name:"bookingData",editable:!1,header:"Bookings",defaultWidth:200,render:function(e){var t=e.value;e.data;try{return Object(S.jsx)(S.Fragment,{children:t.map((function(e){return Object(S.jsx)("a",{href:"#bookings/"+e.id,children:Object(S.jsx)("span",{style:{paddingRight:"5px"},children:e.code})})}))})}catch(n){return}}},{name:"dollaramount",editable:!1,header:"Amount",defaultWidth:90,filterEditor:N.a,render:function(e){var t=e.value;e.data;return"$".concat(t)}},{name:"deposit",header:"Deposit",filterEditor:se.a,defaultWidth:90,render:function(e){return e.value?Object(S.jsx)(je.a,{htmlColor:"green",style:{textAlign:"center",verticalAlign:"center"}}):null},editor:ln.a},{name:"email",editable:!1,header:"Email",defaultWidth:200},{name:"system",editable:!1,header:"System",defaultWidth:130,render:function(e){var t=e.value;return"Stripe"===t?Object(S.jsx)(oe.a,{color:"primary",style:{backgroundColor:"blue"},label:"Stripe"},t):"Square"===t?Object(S.jsx)(oe.a,{color:"primary",style:{backgroundColor:"green"},label:"Square"},t):void 0},filterEditor:T.a,filterEditorProps:{multiple:!0,wrapMultiple:!1,dataSource:["Stripe","Square"].map((function(e){return{id:e,label:e.charAt(0).toUpperCase()+e.slice(1)}}))}}];return a.useEffect((function(){function n(){return(n=Object(f.a)(p.a.mark((function n(){var a,r,c;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=e.rows||[],r=[],a.forEach((function(e){e.booking_ref&&e.booking_ref.forEach((function(e){return r.push(e)}));var t=e.amount/100;e.dollaramount=t})),n.next=5,t.getMany("bookings",{ids:r,pagination:{page:1,perPage:1e6}});case 5:c=n.sent,a.forEach((function(e){if(e.booking_ref){var t=[];e.booking_ref.forEach((function(e){var n=c.data.filter((function(t){return t.id===e}));t.push(n[0])})),e.bookingData=t}})),v(a),w(!1);case 9:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}()}),[e.rows]),C?Object(S.jsx)(H.a,{}):E?Object(S.jsx)(K.a,{}):Object(S.jsxs)(S.Fragment,{children:[A&&Object(S.jsx)(Xn,{refetch:e.refetch}),Object(S.jsx)(O.b,{title:e.title}),Object(S.jsxs)("div",{children:[Object(S.jsx)(x.a,{label:"Filters",onClick:function(){return u(!l)},children:Object(S.jsx)(U.a,{})}),1===Object.keys(c).length&&Object(S.jsx)(g.a,{basePath:"/dogs",label:"Edit",record:Object.values(c)[0]}),0!==Object.keys(c).length&&Object(S.jsx)(x.a,{label:"Message Client",children:Object(S.jsx)(L.a,{})}),0!==Object.keys(c).length&&"Unlinked Payments"===e.title&&Object(S.jsx)(x.a,{onClick:function(){return function(){var e=Object.values(c).map((function(e){return e.id}));Y(e),F()}()},label:"Link Payment",children:Object(S.jsx)(Gn.a,{})})]}),Object(S.jsx)(D.a,{idProperty:"id",columns:_,dataSource:b,style:{minHeight:550},defaultFilterValue:[{name:"status",operator:"inlist",type:"select",value:null},{name:"description",operator:"contains",type:"string",value:""},{name:"name",operator:"contains",type:"string",value:""},{name:"email",operator:"contains",type:"string",value:""},{name:"amount",operator:"gte",type:"number",value:""},{name:"system",operator:"inlist",type:"select",value:null},{name:"deposit",operator:"eq",type:"boolean",value:null}],onSelectionChange:function(e){return i(e.selected)},enableFiltering:l,onEditComplete:W,editable:!0,multiSelect:!0,checkboxColumn:!0})]})}var $n=[Object(S.jsx)(yt.b,{exact:!0,path:"/bookingstoday",component:function(){var e=new Date,t=Object(On.a)({type:"getList",resource:"bookings",payload:{pagination:{page:1,perPage:1e6},filter:{start:xn(e,"yyyy-mm-dd")}}}),n=t.loaded,a=t.error,r=t.data;return n?a?Object(S.jsx)(K.a,{}):Object(S.jsx)(mn,{rows:r,title:"Bookings Today"}):Object(S.jsx)(H.a,{})}}),Object(S.jsx)(yt.b,{exact:!0,path:"/clients",component:function(){var e=Object(On.a)({type:"getList",resource:"clients",payload:{pagination:{page:1,perPage:1e6}}}),t=e.loaded,n=e.error,a=e.data,r=e.refetch;return t?n?Object(S.jsx)(K.a,{}):Object(S.jsx)(Q,{rows:a,refetch:r,title:"Clients"}):Object(S.jsx)(H.a,{})}}),Object(S.jsx)(yt.b,{exact:!0,path:"/todaydaycare",component:function(){var e=new Date,t=Object(On.a)({type:"getList",resource:"bookings",payload:{pagination:{page:1,perPage:1e4},filter:{category:"daycare",start:gn(e,"yyyy-mm-dd")}}}),n=t.loaded,a=t.error,r=t.data;return n?a?Object(S.jsx)(K.a,{}):Object(S.jsx)(mn,{rows:r,title:"Daycare Today"}):Object(S.jsx)(H.a,{})}}),Object(S.jsx)(yt.b,{exact:!0,path:"/dogs",component:function(){var e=Object(On.a)({type:"getList",resource:"dogs",payload:{pagination:{page:1,perPage:1e6}}}),t=e.loaded,n=e.error,a=e.data;return t?n?Object(S.jsx)(K.a,{}):Object(S.jsx)(Ve,{rows:a,title:"Dogs"}):Object(S.jsx)(H.a,{})}}),Object(S.jsx)(yt.b,{exact:!0,path:"/todaygrooming",component:function(){var e=new Date,t=Object(On.a)({type:"getList",resource:"bookings",payload:{pagination:{page:1,perPage:1e4},filter:{category:"stylist",start:vn(e,"yyyy-mm-dd")}}}),n=t.loaded,a=t.error,r=t.data;return n?a?Object(S.jsx)(K.a,{}):Object(S.jsx)(mn,{rows:r,title:"Grooming Today"}):Object(S.jsx)(H.a,{})}}),Object(S.jsx)(yt.b,{exact:!0,path:"/grooming",component:function(){var e=Object(On.a)({type:"getList",resource:"bookings",payload:{pagination:{page:1,perPage:1e6},filter:{category:"stylist"}}}),t=e.loaded,n=e.error,a=e.data;return t?n?Object(S.jsx)(K.a,{}):Object(S.jsx)(mn,{rows:a,title:"Grooming"}):Object(S.jsx)(H.a,{})}}),Object(S.jsx)(yt.b,{exact:!0,path:"/daycare",component:function(){var e=Object(On.a)({type:"getList",resource:"bookings",payload:{pagination:{page:1,perPage:1e6},filter:{category:"daycare"}}}),t=e.loaded,n=e.error,a=e.data;return t?n?Object(S.jsx)(K.a,{}):Object(S.jsx)(mn,{rows:a,title:"Daycare"}):Object(S.jsx)(H.a,{})}}),Object(S.jsx)(yt.b,{exact:!0,path:"/bookings",component:function(){var e=Object(On.a)({type:"getList",resource:"bookings",payload:{pagination:{page:1,perPage:1e6}}}),t=e.loaded,n=e.error,a=e.data;return t?n?Object(S.jsx)(K.a,{}):Object(S.jsx)(mn,{rows:a,title:"All Bookings"}):Object(S.jsx)(H.a,{})}}),Object(S.jsx)(yt.b,{exact:!0,path:"/messenger",component:function(){return Object(S.jsxs)(Xe.a,{children:[Object(S.jsx)(O.b,{title:"Messenger"}),Object(S.jsx)(qn,{})]})}}),Object(S.jsx)(yt.b,{exact:!0,path:"/payments",component:function(){var e=Object(On.a)({type:"getList",resource:"payments",payload:{pagination:{page:1,perPage:1e6}}}),t=e.loaded,n=e.error,a=e.data;return t?n?Object(S.jsx)(K.a,{}):Object(S.jsx)(Zn,{rows:a,title:"All Payments"}):Object(S.jsx)(H.a,{})}}),Object(S.jsx)(yt.b,{exact:!0,path:"/unlinked",component:function(){var e=Object(On.a)({type:"getList",resource:"payments",payload:{filter:{system:"Square",linked:!1},pagination:{page:1,perPage:1e6}}}),t=e.loaded,n=e.error,a=e.data,r=e.refetch;return t?n?Object(S.jsx)(K.a,{}):Object(S.jsx)(Zn,{rows:a,title:"Unlinked Payments",refetch:r}):Object(S.jsx)(H.a,{})}})],ea=n(1811),ta=(n(1745),n(1746),Object(d.b)()),na=function(){var e,t=a.useContext(mt),n=t.openSquareLink,r=t.setPayments;return e=function(e){Y.NotificationManager.success(e.data.body,e.data.title);var t=[];t.push(e.data.data),r(t),n(),ta.push("/unlinked")},Oe.onMessage((function(t){e(t)})),Object(S.jsxs)(ea.a,{utils:tt.a,children:[Object(S.jsx)(Y.NotificationContainer,{}),Object(S.jsxs)(s.a,{disableTelemetry:!0,layout:nn,history:ta,customRoutes:$n,dashboard:et,dataProvider:xe,authProvider:ge,children:[Object(S.jsx)(o.a,{name:"clients",icon:Ke.a,create:G,to:"/clients",edit:J,options:{label:"Clients"}}),Object(S.jsx)(o.a,{name:"dogs",create:ze,edit:Je}),Object(S.jsx)(o.a,{name:"bookings",edit:l.a}),Object(S.jsx)(o.a,{name:"services",list:u.a}),Object(S.jsx)(o.a,{name:"payments"}),Object(S.jsx)(o.a,{name:"notifications"})]})]})};i.a.render(Object(S.jsx)(r.a.StrictMode,{children:Object(S.jsx)(ht,{children:Object(S.jsx)(na,{})})}),document.getElementById("root"))}},[[1747,1,2]]]);
//# sourceMappingURL=main.d670dba2.chunk.js.map